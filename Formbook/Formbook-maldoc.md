# A FormBook Matryoshka

To those unfamiliar, a matryoshka is a set of Russian dolls of reducing size, where one fits inside the other. These things:

![Picture of Matryoshka](https://github.com/dodo-sec/Malware-Analysis/blob/main/Formbook/Russian-Matryoshka-Doll-Transparent.png)

A "malware matryoshka" refers to a sample that has many stages taking place before the final payload is triggered. 
This analysis will tackle a malicious RTF document that spreads the FormBook infostealer and fits this description quite well

## RTF Maldoc

The first stage is a maldoc. For those that wish to follow along, the file is available on Malware Bazaar ([f443d54ed21c034b61c6e71a4f4705f33684d36b5784aa997461a88e99dc5202](https://bazaar.abuse.ch/sample/f443d54ed21c034b61c6e71a4f4705f33684d36b5784aa997461a88e99dc5202/)).
We have two main options when tackling RTF files: either go with Didier Stevens' rtfdump.py or with rtfobj.py from oletools. The second tool provides a more user friendly output and is used with the syntax `rtfobj [FILE]`:

![rtfobj output](https://github.com/dodo-sec/Malware-Analysis/blob/main/Formbook/rtfobj.png)

There are two embedded objects, the first of which is a vbs script. RTF files do not support VBA macros, so embedding the script is a common alternative employed by attackers. The command to save the object to disk is `rtfobj -s 0 f443d54ed21c034b61c6e71a4f4705f33684d36b5784aa997461a88e99dc5202`. 

## Client.vbs

Let's inspect the contents of the embedded vbs file through Notepad++:
